<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=EDGE"><title>AJS.i18n | AUI Documentation</title><link rel="icon" type="image/png" href="../docs/img/favicon.png" />
<link rel="stylesheet" href="../aui/css/aui-all.css" media="all">
<!--[if lt IE 9]><link rel="stylesheet" href="../aui/css/aui-ie.css" media="all"><![endif]-->
<!--[if IE 9]><link rel="stylesheet" href="../aui/css/aui-ie9.css" media="all"><![endif]-->
<script src="../aui/js/aui-all.js"></script>
<!--[if lt IE 9]><script src="../aui/js/aui-ie.js"></script><![endif]-->
<link rel="stylesheet" href="../docs/css/aui-flatpack-extras.css" media="all">
<script src="../docs/js/aui-flatpack-extras.js"></script><link rel="stylesheet" href="../docs/highlightjs/ADG.css" media="all">
<script src="../docs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" href="../docs/css/aui-flatpack-docs.css" media="all">
<script src="../docs/js/aui-flatpack-docs.js"></script>
</head><body id="aui-flatpack"><div id="page"><header id="header" role="banner"><nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class="aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" id="flatpack-app-switcher-trigger"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Design/AUI</span></a><div class="aui-dropdown2 aui-style-default" id="app-switcher"><ul><li><a class="aui-dropdown2-radio interactive checked">AUI</a></li><li><a href="https://developer.atlassian.com/design/latest/" class="aui-dropdown2-radio interactive">Design Guidelines</a></li><li><a href="/sandbox" class="aui-dropdown2-radio interactive">AUI Sandbox</a></li></ul></div></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-aui"><a href="../index.html"><span class="aui-header-logo-device">AUI</span></a></h1>			<ul class="aui-nav">
			    <li><a href="../docs/index.html">Documentation</a></li>
			    <li><a href="../sandbox/index.html">Sandbox</a></li>
			</ul></div></div><!-- .aui-header-inner--></nav><!-- .aui-header --></header><!-- #header --><section id="content" role="main"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1>Documentation</h1></div><!-- .aui-page-header-main --></div><!-- .aui-page-header-inner --></header><!-- .aui-page-header --><div class="aui-page-panel"><div class="aui-page-panel-inner"><div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><div class="aui-nav-heading"><strong>General Components</strong></div><ul class="aui-nav"><li class=""><a href="applicationHeader.html" class="docs-nav-link" id="header-link">Application header</a></li><li class=""><a href="avatars.html" class="docs-nav-link" id="avatars-link">Avatars</a></li><li class=""><a href="badges.html" class="docs-nav-link" id="badges-link">Badges</a></li><li class=""><a href="buttons.html" class="docs-nav-link" id="buttons-link">Buttons</a></li><li class=""><a href="datePicker.html" class="docs-nav-link" id="date-picker-link">Date picker</a></li><li class=""><a href="dialog.html" class="docs-nav-link" id="dialog-link">Dialog</a></li><li class=""><a href="dropdown2.html" class="docs-nav-link" id="dropdown2-link">Dropdown 2</a></li><li class=""><a href="forms.html" class="docs-nav-link" id="forms-link">Forms</a></li><li class=""><a href="hiddenAssistiveCSS.html" class="docs-nav-link" id="hidden-assistive-css-link">Hidden and assistive CSS</a></li><li class=""><a href="icons.html" class="docs-nav-link" id="icons-link">Icons</a></li><li class=""><a href="inlineDialog.html" class="docs-nav-link" id="inline-dialog-link">Inline dialog</a></li><li class=""><a href="keyboard.html" class="docs-nav-link" id="keyboard-link">Keyboard shortcuts</a></li><li class=""><a href="layout.html" class="docs-nav-link" id="layout-link">Layout</a></li><li class=""><a href="lozenges.html" class="docs-nav-link" id="lozenges-link">Lozenges</a></li><li class=""><a href="messages.html" class="docs-nav-link" id="messages-link">Messages</a></li><li class=""><a href="navigation.html" class="docs-nav-link" id="navigation-link">Navigation</a></li><li class=""><a href="page.html" class="docs-nav-link" id="page-link">Page</a></li><li class=""><a href="pageContentLayout.html" class="docs-nav-link" id="page-content-layout-link">Page content layout</a></li><li class=""><a href="pageHeader.html" class="docs-nav-link" id="page-header-link">Page header</a></li><li class=""><a href="tables.html" class="docs-nav-link" id="tables-link">Tables</a></li><li class=""><a href="tabs.html" class="docs-nav-link" id="tabs-link">Tabs</a></li><li class=""><a href="template.html" class="docs-nav-link" id="template-link">Template</a></li><li class=""><a href="typography.html" class="docs-nav-link" id="typography-link">Typography</a></li><li class=""><a href="toolbar2.html" class="docs-nav-link" id="toolbar2-link">Toolbar 2</a></li></ul><div class="aui-nav-heading"><strong>Experimental</strong></div><ul class="aui-nav"><li class=""><a href="expander.html" class="docs-nav-link" id="expander-link">Expander</a></li><li class=""><a href="labels.html" class="docs-nav-link" id="labels-link">Labels</a></li><li class=""><a href="mobile.html" class="docs-nav-link" id="mobile-link">Mobile</a></li><li class=""><a href="progressIndicator.html" class="docs-nav-link" id="progress-indicator-link">Progress Indicator</a></li><li class=""><a href="progressTracker.html" class="docs-nav-link" id="progress-tracker-link">Progress tracker</a></li><li class=""><a href="restfulTable.html" class="docs-nav-link" id="restful-table-link">RESTful table</a></li><li class=""><a href="sidebar.html" class="docs-nav-link" id="sidebar-link">Sidebar</a></li><li class=""><a href="sortableTable.html" class="docs-nav-link" id="sortable-table-link">Sortable table</a></li><li class=""><a href="soy.html" class="docs-nav-link" id="soy-link">Soy</a></li><li class=""><a href="spinner.html" class="docs-nav-link" id="spinner-link">Spinner</a></li><li class=""><a href="tooltips.html" class="docs-nav-link" id="tooltips-link">Tooltips</a></li></ul><div class="aui-nav-heading"><strong>Other</strong></div><ul class="aui-nav"><li class=""><a href="helper.html" class="docs-nav-link" id="helper-link">Helper functions</a></li><li class=""><a href="components.html" class="docs-nav-link" id="components-link">Components matrix</a></li><li class=""><a href="allIn.html" class="docs-nav-link" id="all-in-link">All-in</a></li></ul></div></nav></div><section class="aui-page-panel-content"><h2 class="component-heading">AJS.i18n</h2><h3>Summary</h3><p>AUI includes a web resource transformer that will translate some javascript into the literal strings before being served.</p><h3>Status</h3><table class="aui summary"><tbody><tr><th>API status:</th><td><span class="aui-lozenge aui-lozenge-success">general</span></td></tr><tr><th>Included in AUI core?</th><td>Yes. You do not need to explicitly require the web resource key.</td></tr><tr><th>Web resource key:</th><td class="resource-key" data-resource-key="com.atlassian.auiplugin:ajs"><code>com.atlassian.auiplugin:ajs</code></td></tr><tr><th>Experimental since:</th><td>3.3</td></tr><tr><th>General API status:</th><td>5.0</td></tr><tr></tr><tr></tr><tr></tr></tbody></table><h3>Examples</h3><pre><code class="javascript">var label = AJS.I18n.getText(&quot;close.button&quot;);</code></pre><p> will be translated by the transformer into:<pre><code class="javascript">var label = &quot;Close&quot;;</code></pre><h3>Code</h3><h4> Using the transformer in your application</h4><h4> 1. Add user locale to the caching url prefix </h4><p> If your application serves javascript resources with a caching url prefix (typically done through the WebResourceManager if you use Atlassian Plugins), you'll need to update it to include the user locale so that the translated resources are invalidated when a user changes their configured language.</p><h5>Prior to Atlassian plugins 2.8.0 </h5><p>For example, Confluence's caching url prefix is typically something like /s/BUILD_NUMBER/SYSTEM_COUNTER// and has been to be updated to /s/LANG/BUILD_NUMBER/SYSTEM_COUNTER// in Confluence's implementation of the WebResourceManager.</p><pre><code class="java">/**
     * Override to include user lanaguage in the prefix
     */
    @Override
    public String getStaticResourcePrefix(UrlMode urlMode)
    {
        // &quot;{base url}/s/{lang}/{build num}/{system counter}/_&quot;
        return webResourceIntegration.getBaseUrl(urlMode) + &quot;/&quot; + STATIC_RESOURCE_PREFIX + &quot;/&quot; + getLanguage() + &quot;/&quot; +
            webResourceIntegration.getSystemBuildNumber() + &quot;/&quot; + webResourceIntegration.getSystemCounter() + &quot;/&quot; + STATIC_RESOURCE_SUFFIX;
    }
 
    /**
     * Override to include user lanaguage in the prefix
     */
    @Override
    public String getStaticResourcePrefix(String resourceCounter, UrlMode urlMode)
    {
        // &quot;{base url}/s/{lang}/{build num}/{system counter}/{resource counter}/_&quot;
        return webResourceIntegration.getBaseUrl(urlMode) + &quot;/&quot; + STATIC_RESOURCE_PREFIX + &quot;/&quot; + getLanguage() + &quot;/&quot; +
            webResourceIntegration.getSystemBuildNumber() + &quot;/&quot; + webResourceIntegration.getSystemCounter() + &quot;/&quot; + resourceCounter + &quot;/&quot; + STATIC_RESOURCE_SUFFIX;
    }
 
    private String getLanguage()
    {
        Locale locale = localeManager.getLocale(AuthenticatedUserThreadLocal.getUser());
        return locale.getLanguage();
    }</code></pre><h5>In Atlassian plugins 2.8.0 or later</h5><p>You need to implement getStaticResourceLocale() from WebResourceIntegration instead of overriding the two methods above.</p><h4> 2. Apply the transformer to your scripts </h4><p>You need to mark which web resources you want the transformer to run on. You do this by adding some <transformation> markup to your web resource definitions.</p><pre><code class="xml">&lt;web-resource key=&quot;labels-editor&quot; name=&quot;Confluence Labels Editor&quot; i18n-name-key=&quot;admin.web.resources.plugin.labels.editor.name&quot;&gt;
        &lt;!-- Applies the transformer to all js resources defined within this web resource --&gt;
    &lt;transformation extension=&quot;js&quot;&gt;
            &lt;transformer key=&quot;jsI18n&quot;/&gt;
        &lt;/transformation&gt;
        
    &lt;resource type=&quot;download&quot; name=&quot;labels.js&quot; location=&quot;/includes/js/labels.js&quot;&gt;
            &lt;param name=&quot;source&quot; value=&quot;webContextStatic&quot;/&gt;
        &lt;/resource&gt;
        &lt;resource type=&quot;download&quot; name=&quot;labels-editor.js&quot; location=&quot;/includes/js/labels-editor.js&quot;&gt;
            &lt;param name=&quot;source&quot; value=&quot;webContextStatic&quot;/&gt;
        &lt;/resource&gt;
        &lt;resource type=&quot;download&quot; name=&quot;labels.css&quot; location=&quot;/includes/css/labels.css&quot;&gt;
            &lt;param name=&quot;source&quot; value=&quot;webContextStatic&quot;/&gt;
        &lt;/resource&gt;
        &lt;dependency&gt;confluence.web.resources:ajs&lt;/dependency&gt;
    &lt;/web-resource&gt;</code></pre><p> For the transformer to work, the syntax AJS.I18n.getText("key") must be used, where "key" must only contain letters, numbers, dots and hyphens. </p><p>Important Notes:</p><ul><li>it currently only supports double quotes around the key</li><li>you cannot have the key be dynamically generated or have line breaks</li></ul><p>The transformer is very simple (it does not parse javascript) and can only transform the static string in the above format.</p></section><!-- .aui-page-panel-content --></div><!-- .aui-page-panel-inner --></div><!-- .aui-page-panel --></section><!-- #content --><footer id="footer" role="contentinfo">
            <section class="footer-body">
                <ul id="aui-footer-list">
                    <li>Copyright &copy; 2009-2013 Atlassian</li>
                    <li><a href="https://developer.atlassian.com/display/AUI/License">Apache License v2.0</a></li>
                    <li><a href="https://developer.atlassian.com/display/AUI/AUI+Release+Notes">Release Notes</a></li>
                </ul>
                <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
            </section>
</footer><!-- #footer --></div><!-- #page --></body></html>